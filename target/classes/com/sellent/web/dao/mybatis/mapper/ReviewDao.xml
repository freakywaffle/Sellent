<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.sellent.web.dao.ReviewDao">
	<insert id="insert" parameterType="com.sellent.web.entity.Review">
		insert into review(
			product_no, 
			writer_id, 
			content, 
			starpoint) 
		values(
			#{product_no},
			#{writer_id},
			#{content},
			#{starpoint})
	</insert>
	<select id="getListByProductNo" parameterType="java.lang.Integer" resultType="com.sellent.web.entity.ReviewView">
		select * 
		from (
			select (@rownum:= @rownum+1) as rownum
			, reviewView.* from reviewView
			, (select @rownum:=0) as r  
		where product_no = #{param1} 
		order by regdate desc) rv 
		where rownum &lt;= #{param2};
	</select>
	<select id="getAvgStarPointByProductNo" resultType="double">
		select round(avg(starpoint),1) from review where product_no = #{param1}
	</select>
</mapper>